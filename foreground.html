<!DOCTYPE html><html lang="en"><head><meta charset="utf-8" /><title>Foreground Estimation â€” PyMatting 1.1.14 documentation</title><link rel="stylesheet" href="/katex.min.css"><link rel="stylesheet" href="/style.css"><script src="/katex.min.js"></script></head><body><div class="sidebar"><div class="logo"><a href="/" class="sidebarlink"><img src="/figures/lemur_small.png" width="50px"></a><a href="/" class="logotext">PyMatting</a></div><div class="sidebarcontents">CONTENTS</div><ul><li><a href="/index.html" class="sidebarlink">PyMatting</a></li><li class="sidebarlink"><a href="/api.html" class="sidebarlink">API Reference</a><br><ul><li><a href="/alpha.html" class="sidebarlink">Alpha Estimation</a></li><li><a href="/cutout.html" class="sidebarlink">Cutout Function</a></li><li><a href="/foreground.html" class="sidebarlink currentpage">Foreground Estimation</a></li><li><a href="/laplacian.html" class="sidebarlink">Matting Laplacians</a></li><li><a href="/preconditioner.html" class="sidebarlink">Preconditioners</a></li><li><a href="/solver.html" class="sidebarlink">Solvers</a></li><li><a href="/util.html" class="sidebarlink">Utility Functions</a></li></ul></li><li><a href="/examples.html" class="sidebarlink">Examples</a></li><li><a href="/benchmarks.html" class="sidebarlink">Benchmarks</a></li><li><a href="/references.html" class="sidebarlink">Biblography</a></li><li><a href="https://pypi.org/project/PyMatting/" class="sidebarlink">PyPI</a></li><li><a href="https://www.github.com/pymatting/pymatting" class="sidebarlink">GitHub</a></li></ul></div><div class="middle"><h1>Foreground Estimation</h1><div><div class="function"><div id="estimate_foreground_cf"><a href="https://github.com/pymatting/pymatting/blob/master/pymatting/foreground/estimate_foreground_cf.py#L8-L130"><img src="/figures/github-mark.svg" title="Function definition on GitHub" class="github-icon"></a><h3 class="functionname">pymatting.estimate_foreground_cf</h3><a href="#estimate_foreground_cf" title="Permalink to this definition" class="functionanchorlink"> ðŸ”—</a></div><div class="signature"><h4>Signature</h4><div class="signature"><div class="codeblock"><span class=name>estimate_foreground_cf</span><span class=operator>(</span><span class=space>
    </span><span class=name>image</span><span class=operator>,</span><span class=space>
    </span><span class=name>alpha</span><span class=operator>,</span><span class=space>
    </span><span class=name>regularization</span><span class=operator>=</span><span class=number>1e-5</span><span class=operator>,</span><span class=space>
    </span><span class=name>rtol</span><span class=operator>=</span><span class=number>1e-5</span><span class=operator>,</span><span class=space>
    </span><span class=name>neighbors</span><span class=operator>=</span><span class=operator>[</span><span class=operator>(</span><span class=operator>-</span><span class=number>1</span><span class=operator>,</span><span class=space> </span><span class=number>0</span><span class=operator>)</span><span class=operator>,</span><span class=space> </span><span class=operator>(</span><span class=number>1</span><span class=operator>,</span><span class=space> </span><span class=number>0</span><span class=operator>)</span><span class=operator>,</span><span class=space> </span><span class=operator>(</span><span class=number>0</span><span class=operator>,</span><span class=space> </span><span class=operator>-</span><span class=number>1</span><span class=operator>)</span><span class=operator>,</span><span class=space> </span><span class=operator>(</span><span class=number>0</span><span class=operator>,</span><span class=space> </span><span class=number>1</span><span class=operator>)</span><span class=operator>]</span><span class=operator>,</span><span class=space>
    </span><span class=name>return_background</span><span class=operator>=</span><span class=keyword>False</span><span class=operator>,</span><span class=space>
    </span><span class=name>foreground_guess</span><span class=operator>=</span><span class=keyword>None</span><span class=operator>,</span><span class=space>
    </span><span class=name>background_guess</span><span class=operator>=</span><span class=keyword>None</span><span class=operator>,</span><span class=space>
    </span><span class=name>ichol_kwargs</span><span class=operator>=</span><span class=operator>{</span><span class=operator>}</span><span class=operator>,</span><span class=space>
    </span><span class=name>cg_kwargs</span><span class=operator>=</span><span class=operator>{</span><span class=operator>}</span><span class=operator>)</span></div></div></div><h4>Function Description</h4><div class="textblock"><span class="text">Estimates the foreground of an image given alpha matte and image.</span></div><div class="textblock"><span class="text">This method is based on the publication </span><span class="citation"><a href="/references.html#LLW07">[LLW07]</a></span><span class="text">.</span></div><h4>Parameters</h4><ul><li class="parameteritem"><span class="parameter">image</span> (<i>numpy.ndarray</i>)<ul><div class="parameterdescription"><span class="text">Input image with shape </span><span class="inline_math">\(h \times  w \times d\)</span></div></ul></li><li class="parameteritem"><span class="parameter">alpha</span> (<i>numpy.ndarray</i>)<ul><div class="parameterdescription"><span class="text">Input alpha matte with shape </span><span class="inline_math">\(h \times  w\)</span></div></ul></li><li class="parameteritem"><span class="parameter">regularization</span> (<i>float</i>)<ul><div class="parameterdescription"><span class="text">Regularization strength </span><span class="inline_math">\(\epsilon\)</span><span class="text">, defaults to </span><span class="inline_math">\(10^{-5}\)</span></div></ul></li><li class="parameteritem"><span class="parameter">neighbors</span> (<i>list of tuples of ints</i>)<ul><div class="parameterdescription"><span class="text">List of relative positions that define the neighborhood of a pixel</span></div></ul></li><li class="parameteritem"><span class="parameter">return_background</span> (<i>bool</i>)<ul><div class="parameterdescription"><span class="text">Whether to return the estimated background in addition to the foreground</span></div></ul></li><li class="parameteritem"><span class="parameter">foreground_guess</span> (<i>numpy.ndarray</i>)<ul><div class="parameterdescription"><span class="text">An initial guess for the foreground image in order to accelerate convergence. </span><span class="text">Using input image by default.</span></div></ul></li><li class="parameteritem"><span class="parameter">background_guess</span> (<i>numpy.ndarray</i>)<ul><div class="parameterdescription"><span class="text">An initial guess for the background image. </span><span class="text">Using input image by default.</span></div></ul></li><li class="parameteritem"><span class="parameter">ichol_kwargs</span> (<i>dictionary</i>)<ul><div class="parameterdescription"><span class="text">Keyword arguments for the incomplete Cholesky preconditioner</span></div></ul></li><li class="parameteritem"><span class="parameter">cg_kwargs</span> (<i>dictionary</i>)<ul><div class="parameterdescription"><span class="text">Keyword arguments for the conjugate gradient descent solver</span></div></ul></li></ul><h4>Returns</h4><ul><li class="parameteritem"><span class="parameter">F</span> (<i>numpy.ndarray</i>)<ul><div class="parameterdescription"><span class="text">Extracted foreground</span></div></ul></li><li class="parameteritem"><span class="parameter">B</span> (<i>numpy.ndarray</i>)<ul><div class="parameterdescription"><span class="text">Extracted background (not returned by default)</span></div></ul></li></ul><div class="block"><h4>Example</h4><div class="code_block"><div class="codeblock"><span class=indentation>&gt;&gt;&gt; </span><span class=keyword>from</span><span class=space> </span><span class=name>pymatting</span><span class=space> </span><span class=keyword>import</span><span class=space> </span><span class=operator>*</span><span class=space>
</span><span class=indentation>&gt;&gt;&gt; </span><span class=name>image</span><span class=space> </span><span class=operator>=</span><span class=space> </span><span class=name>load_image</span><span class=operator>(</span><span class=string>&quot;data/lemur/lemur.png&quot;</span><span class=operator>,</span><span class=space> </span><span class=string>&quot;RGB&quot;</span><span class=operator>)</span><span class=space>
</span><span class=indentation>&gt;&gt;&gt; </span><span class=name>alpha</span><span class=space> </span><span class=operator>=</span><span class=space> </span><span class=name>load_image</span><span class=operator>(</span><span class=string>&quot;data/lemur/lemur_alpha.png&quot;</span><span class=operator>,</span><span class=space> </span><span class=string>&quot;GRAY&quot;</span><span class=operator>)</span><span class=space>
</span><span class=indentation>&gt;&gt;&gt; </span><span class=name>F</span><span class=space> </span><span class=operator>=</span><span class=space> </span><span class=name>estimate_foreground_cf</span><span class=operator>(</span><span class=name>image</span><span class=operator>,</span><span class=space> </span><span class=name>alpha</span><span class=operator>,</span><span class=space> </span><span class=name>return_background</span><span class=operator>=</span><span class=keyword>False</span><span class=operator>)</span><span class=space>
</span><span class=indentation>&gt;&gt;&gt; </span><span class=name>F</span><span class=operator>,</span><span class=space> </span><span class=name>B</span><span class=space> </span><span class=operator>=</span><span class=space> </span><span class=name>estimate_foreground_cf</span><span class=operator>(</span><span class=name>image</span><span class=operator>,</span><span class=space> </span><span class=name>alpha</span><span class=operator>,</span><span class=space> </span><span class=name>return_background</span><span class=operator>=</span><span class=keyword>True</span><span class=operator>)</span></div></div></div><h4>See Also</h4><ul></ul><div class="textblock"><span class="text">stack_images: This function can be used to place the foreground on a new background.</span></div></div></div><div><div class="function"><div id="estimate_foreground_ml"><a href="https://github.com/pymatting/pymatting/blob/master/pymatting/foreground/estimate_foreground_ml.py#L186-L253"><img src="/figures/github-mark.svg" title="Function definition on GitHub" class="github-icon"></a><h3 class="functionname">pymatting.estimate_foreground_ml</h3><a href="#estimate_foreground_ml" title="Permalink to this definition" class="functionanchorlink"> ðŸ”—</a></div><div class="signature"><h4>Signature</h4><div class="signature"><div class="codeblock"><span class=name>estimate_foreground_ml</span><span class=operator>(</span><span class=space>
    </span><span class=name>image</span><span class=operator>,</span><span class=space>
    </span><span class=name>alpha</span><span class=operator>,</span><span class=space>
    </span><span class=name>regularization</span><span class=operator>=</span><span class=number>1e-5</span><span class=operator>,</span><span class=space>
    </span><span class=name>n_small_iterations</span><span class=operator>=</span><span class=number>10</span><span class=operator>,</span><span class=space>
    </span><span class=name>n_big_iterations</span><span class=operator>=</span><span class=number>2</span><span class=operator>,</span><span class=space>
    </span><span class=name>small_size</span><span class=operator>=</span><span class=number>32</span><span class=operator>,</span><span class=space>
    </span><span class=name>return_background</span><span class=operator>=</span><span class=keyword>False</span><span class=operator>,</span><span class=space>
    </span><span class=name>gradient_weight</span><span class=operator>=</span><span class=number>1.0</span><span class=operator>)</span></div></div></div><h4>Function Description</h4><div class="textblock"><span class="text">Estimates the foreground of an image given its alpha matte.</span></div><div class="textblock"><span class="text">See </span><span class="citation"><a href="/references.html#GUCH20">[GUCH20]</a></span><span class="text"> for reference.</span></div><h4>Parameters</h4><ul><li class="parameteritem"><span class="parameter">image</span> (<i>numpy.ndarray</i>)<ul><div class="parameterdescription"><span class="text">Input image with shape </span><span class="inline_math">\(h \times  w \times d\)</span></div></ul></li><li class="parameteritem"><span class="parameter">alpha</span> (<i>numpy.ndarray</i>)<ul><div class="parameterdescription"><span class="text">Input alpha matte shape </span><span class="inline_math">\(h \times  w\)</span></div></ul></li><li class="parameteritem"><span class="parameter">regularization</span> (<i>float</i>)<ul><div class="parameterdescription"><span class="text">Regularization strength </span><span class="inline_math">\(\epsilon\)</span><span class="text">, defaults to </span><span class="inline_math">\(10^{-5}\)</span><span class="text">.</span><span class="text"> </span><span class="text">Higher regularization results in smoother colors.</span></div></ul></li><li class="parameteritem"><span class="parameter">n_small_iterations</span> (<i>int</i>)<ul><div class="parameterdescription"><span class="text">Number of iterations performed on small scale, defaults to </span><span class="inline_math">\(10\)</span></div></ul></li><li class="parameteritem"><span class="parameter">n_big_iterations</span> (<i>int</i>)<ul><div class="parameterdescription"><span class="text">Number of iterations performed on large scale, defaults to </span><span class="inline_math">\(2\)</span></div></ul></li><li class="parameteritem"><span class="parameter">small_size</span> (<i>int</i>)<ul><div class="parameterdescription"><span class="text">Threshold that determines at which size </span><span class="inline_code"><span class="codeinline"><span class=name>n_small_iterations</span></span></span><span class="text"> should be used</span></div></ul></li><li class="parameteritem"><span class="parameter">return_background</span> (<i>bool</i>)<ul><div class="parameterdescription"><span class="text">Whether to return the estimated background in addition to the foreground</span></div></ul></li><li class="parameteritem"><span class="parameter">gradient_weight</span> (<i>float</i>)<ul><div class="parameterdescription"><span class="text">Larger values enforce smoother foregrounds, defaults to </span><span class="inline_math">\(1\)</span></div></ul></li></ul><h4>Returns</h4><ul><li class="parameteritem"><span class="parameter">F</span> (<i>numpy.ndarray</i>)<ul><div class="parameterdescription"><span class="text">Extracted foreground</span></div></ul></li><li class="parameteritem"><span class="parameter">B</span> (<i>numpy.ndarray</i>)<ul><div class="parameterdescription"><span class="text">Extracted background</span></div></ul></li></ul><div class="block"><h4>Example</h4><div class="code_block"><div class="codeblock"><span class=indentation>&gt;&gt;&gt; </span><span class=keyword>from</span><span class=space> </span><span class=name>pymatting</span><span class=space> </span><span class=keyword>import</span><span class=space> </span><span class=operator>*</span><span class=space>
</span><span class=indentation>&gt;&gt;&gt; </span><span class=name>image</span><span class=space> </span><span class=operator>=</span><span class=space> </span><span class=name>load_image</span><span class=operator>(</span><span class=string>&quot;data/lemur/lemur.png&quot;</span><span class=operator>,</span><span class=space> </span><span class=string>&quot;RGB&quot;</span><span class=operator>)</span><span class=space>
</span><span class=indentation>&gt;&gt;&gt; </span><span class=name>alpha</span><span class=space> </span><span class=operator>=</span><span class=space> </span><span class=name>load_image</span><span class=operator>(</span><span class=string>&quot;data/lemur/lemur_alpha.png&quot;</span><span class=operator>,</span><span class=space> </span><span class=string>&quot;GRAY&quot;</span><span class=operator>)</span><span class=space>
</span><span class=indentation>&gt;&gt;&gt; </span><span class=name>F</span><span class=space> </span><span class=operator>=</span><span class=space> </span><span class=name>estimate_foreground_ml</span><span class=operator>(</span><span class=name>image</span><span class=operator>,</span><span class=space> </span><span class=name>alpha</span><span class=operator>,</span><span class=space> </span><span class=name>return_background</span><span class=operator>=</span><span class=keyword>False</span><span class=operator>)</span><span class=space>
</span><span class=indentation>&gt;&gt;&gt; </span><span class=name>F</span><span class=operator>,</span><span class=space> </span><span class=name>B</span><span class=space> </span><span class=operator>=</span><span class=space> </span><span class=name>estimate_foreground_ml</span><span class=operator>(</span><span class=name>image</span><span class=operator>,</span><span class=space> </span><span class=name>alpha</span><span class=operator>,</span><span class=space> </span><span class=name>return_background</span><span class=operator>=</span><span class=keyword>True</span><span class=operator>)</span></div></div></div><h4>See Also</h4><ul></ul><div class="textblock"><span class="text">stack_images: This function can be used to place the foreground on a new background.</span></div></div></div><div><div class="function"><div id="estimate_foreground_ml_cupy"><a href="https://github.com/pymatting/pymatting/blob/master/pymatting/foreground/estimate_foreground_ml_cupy.py#L110-L230"><img src="/figures/github-mark.svg" title="Function definition on GitHub" class="github-icon"></a><h3 class="functionname">pymatting.estimate_foreground_ml_cupy</h3><a href="#estimate_foreground_ml_cupy" title="Permalink to this definition" class="functionanchorlink"> ðŸ”—</a></div><div class="signature"><h4>Signature</h4><div class="signature"><div class="codeblock"><span class=name>estimate_foreground_ml_cupy</span><span class=operator>(</span><span class=space>
    </span><span class=name>input_image</span><span class=operator>,</span><span class=space>
    </span><span class=name>input_alpha</span><span class=operator>,</span><span class=space>
    </span><span class=name>regularization</span><span class=operator>=</span><span class=number>1e-5</span><span class=operator>,</span><span class=space>
    </span><span class=name>n_small_iterations</span><span class=operator>=</span><span class=number>10</span><span class=operator>,</span><span class=space>
    </span><span class=name>n_big_iterations</span><span class=operator>=</span><span class=number>2</span><span class=operator>,</span><span class=space>
    </span><span class=name>small_size</span><span class=operator>=</span><span class=number>32</span><span class=operator>,</span><span class=space>
    </span><span class=name>block_size</span><span class=operator>=</span><span class=operator>(</span><span class=number>32</span><span class=operator>,</span><span class=space> </span><span class=number>32</span><span class=operator>)</span><span class=operator>,</span><span class=space>
    </span><span class=name>return_background</span><span class=operator>=</span><span class=keyword>False</span><span class=operator>,</span><span class=space>
    </span><span class=name>to_numpy</span><span class=operator>=</span><span class=keyword>True</span><span class=operator>)</span></div></div></div><h4>Function Description</h4><div class="textblock"><span class="text">See the </span><span class="inline_code"><span class="codeinline"><span class=name>estimate_foreground</span></span></span><span class="text"> method for documentation.</span></div></div></div><div><div class="function"><div id="estimate_foreground_ml_pyopencl"><a href="https://github.com/pymatting/pymatting/blob/master/pymatting/foreground/estimate_foreground_ml_pyopencl.py#L105-L229"><img src="/figures/github-mark.svg" title="Function definition on GitHub" class="github-icon"></a><h3 class="functionname">pymatting.estimate_foreground_ml_pyopencl</h3><a href="#estimate_foreground_ml_pyopencl" title="Permalink to this definition" class="functionanchorlink"> ðŸ”—</a></div><div class="signature"><h4>Signature</h4><div class="signature"><div class="codeblock"><span class=name>estimate_foreground_ml_pyopencl</span><span class=operator>(</span><span class=space>
    </span><span class=name>input_image</span><span class=operator>,</span><span class=space>
    </span><span class=name>input_alpha</span><span class=operator>,</span><span class=space>
    </span><span class=name>regularization</span><span class=operator>=</span><span class=number>1e-5</span><span class=operator>,</span><span class=space>
    </span><span class=name>n_small_iterations</span><span class=operator>=</span><span class=number>10</span><span class=operator>,</span><span class=space>
    </span><span class=name>n_big_iterations</span><span class=operator>=</span><span class=number>2</span><span class=operator>,</span><span class=space>
    </span><span class=name>small_size</span><span class=operator>=</span><span class=number>32</span><span class=operator>,</span><span class=space>
    </span><span class=name>return_background</span><span class=operator>=</span><span class=keyword>False</span><span class=operator>)</span></div></div></div><h4>Function Description</h4><div class="textblock"><span class="text">See the </span><span class="inline_code"><span class="codeinline"><span class=name>estimate_foreground</span></span></span><span class="text"> method for documentation.</span></div></div></div><footer>Â© Copyright 2025, Thomas Germer, Tobias Uelwer, Stefan Conrad, Stefan Harmeling</footer></div><script src="/auto-render.min.js" onload="renderMathInElement(document.body)"></script></body></html>